@page
@model MyApp.Namespace.QueryCrudModel

<form method="post">
    <div class="row text-center">
        <div class="col-6 justify-content-center">
            <h5>Product Query</h5>
            <div class="row mb-3 justify-content-center">
                <div class="col-2">
                    <label for="PartialProductName" class="col-form-label">Product</label>
                </div>
                <div class="col-4">
                    <input type="search" class="form-control" 
                        placeholder="Partial Name" 
                        id="PartialProductName" 
                        name="PartialProductName" value="@Model.PartialProductName">
                </div>
                <div class="col-2">
                    <button type="submit" class="btn btn-dark" 
                        name="ButtonPressed" value="SearchByPartialProductName">
                        Search
                    </button>
                </div>
            </div>
            <div class="row mb-3 justify-content-center">
                <div class="col-2">
                    <label for="SelectedCategoryId" class="col-form-label">Category</label>
                </div>
                <div class="col-4">
                    <select class="form-select" id="SelectedCategoryId" name="SelectedCategoryId">
                        <option value="0">select ...</option>
                        @foreach (var item in Model.SelectListOfCategories)
                        {
                            <option value="@item.ValueField" 
                                selected=@(Model.SelectedCategoryId == item.ValueField)>
                                @item.DisplayField
                            </option>
                        }
                    </select>
                </div>
                <div class="col-2">
                    <button type="submit" class="btn btn-dark" 
                        name="ButtonPressed" value="SearchByCategory">
                        Search
                    </button>
                </div>
                <input type="hidden" name="FilterType" value="@Model.FilterType">
            </div>
            @if(Model.SearchedProducts != null)
            {
                <div id="table_box_bootstrap">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Action</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>QuantPerUnit</th>
                                <th>UnitPrice</th>
                                <th>Tax</th>       
                            </tr>
                        </thead>
                        <tbody>
                            @if(Model.SearchedProducts.Count == 0)
                            {
                                <tr><td colspan="6"><i>There are no Products available.</i></td></tr>
                            }
                            @foreach(var item in Model.SearchedProducts)
                            {
                                <tr>
                                    <td>
                                        <button type="submit" class="btn btn-dark" 
                                        name="Product.ProductId" value="@item.ProductId">
                                        Edit
                                        </button>
                                    </td>
                                    <td>@item.ProductName</td>
                                    <td>@item.CategoryName</td>
                                    <td>@item.UnitSize</td>
                                    <td>@item.Price</td>
                                    <td>
                                        <input type="checkbox" disabled checked="@item.Taxable">
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            
           
        </div>
    </div>
</form>

<script type="text/javascript" src="~/js/paginator.js"></script>

<script type="text/javascript">
window.addEventListener("load", function () {
    let box = paginator({
        table: document.getElementById("table_box_bootstrap").getElementsByTagName("table")[0],
        box_mode: "list",
    });
    box.className = "box";
    let mytarget = document.getElementById("table_box_bootstrap");
    mytarget.appendChild(box);
    mytarget.style.display = 'block';
}, false);
</script>
